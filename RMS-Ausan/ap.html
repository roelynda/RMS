<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Attendance & Payroll Dashboard</title>
    <link rel="stylesheet" href="Attendance and Payroll Manaement/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>

   <!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h2>RMS</h2>
        <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    </div>
    <div class="menu">
        <a class="menu-item" href="index.html">
            <i class="fas fa-home"></i>
            <span class="menu-text">Dashboard</span>
        </a>
        <a class="menu-item" href="inventory.html">
            <i class="fas fa-boxes-stacked"></i>
            <span class="menu-text">Inventory</span>
        </a>
        <a class="menu-item" href="cm.html">
            <i class="fas fa-users"></i>
            <span class="menu-text">Customers</span>
        </a>
        <a class="menu-item" href="erm.html">
            <i class="fas fa-user-tie"></i>
            <span class="menu-text">Employees & Roles</span>
        </a>
        <a class="menu-item active" href="#">
            <i class="fas fa-clock"></i>
            <span class="menu-text">Attendance & Payroll</span>
        </a>
        <a class="menu-item" href="service.html">
            <i class="fas fa-scissors"></i>
            <span class="menu-text">Services</span>
        </a>
        <a class="menu-item" href="sra.html">
            <i class="fas fa-chart-line"></i>
            <span class="menu-text">Sales Report</span>
        </a>
        <hr style="border-color:rgba(255,255,255,0.1); margin:15px 20px;">
        <a class="menu-item" href="#" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            <span class="menu-text">Logout</span>
        </a>
    </div>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
    <div class="topbar">
        <div class="page-title">Attendance & Payroll Management</div>
        <a href="index.html" class="back-link">← Back to Dashboard</a>
    </div>

    <div class="content-card">
        <div class="tabs">
            <div class="tab active" onclick="showTab('attendance')">Attendance</div>
            <div class="tab" onclick="showTab('payroll')">Payroll</div>
            <div class="tab" onclick="showTab('cashAdvances')">Cash Advances</div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance" class="tab-content active">
            <div style="margin-bottom: 24px; display: flex; justify-content: flex-end;">
                <button class="btn btn-primary" onclick="openTimeModal()">
                    <i class="fas fa-clock"></i> Record Attendance
                </button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Date</th>
                        <th>Time In</th>
                        <th>Time Out</th>
                        <th>Hours</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="attendanceTable"></tbody>
            </table>
        </div>

        <!-- Payroll Tab -->
        <div id="payroll" class="tab-content">
            <div style="margin-bottom: 24px; display: flex; justify-content: flex-end;">
                <button class="btn btn-primary" onclick="openPayrollModal()">
                    <i class="fas fa-calculator"></i> Process Payroll
                </button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Period</th>
                        <th>Gross</th>
                        <th>Cash Advances</th>
                        <th>Net Pay</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="payrollTable"></tbody>
            </table>
        </div>

        <!-- Cash Advances Tab -->
        <div id="cashAdvances" class="tab-content">
            <div style="margin-bottom: 24px; display: flex; justify-content: flex-end;">
                <button class="btn btn-primary" onclick="openCashAdvanceModal()">
                    <i class="fas fa-money-check"></i> Record Cash Advance
                </button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Deducted</th>
                    </tr>
                </thead>
                <tbody id="advancesTable"></tbody>
            </table>
        </div>
    </div>
</div>

<!-- Time Record Modal -->
<div id="timeModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal('timeModal')">×</span>
        <h2>Record Attendance</h2>
        <form id="timeForm">
            <div class="form-field">
                <select id="employeeSelect" required>
                    <option value="">Select Employee</option>
                </select>
                <label>Employee</label>
            </div>
            <div class="form-field">
                <input type="date" id="attDate" required>
                <label>Date</label>
            </div>
            <div style="display:flex; gap:16px;">
                <div class="form-field" style="flex:1;">
                    <input type="time" id="timeIn" required>
                    <label>Time In</label>
                </div>
                <div class="form-field" style="flex:1;">
                    <input type="time" id="timeOut">
                    <label>Time Out (optional)</label>
                </div>
            </div>
            <div style="margin-top:28px; display:flex; gap:16px; justify-content:flex-end;">
                <button type="button" class="btn btn-secondary" onclick="closeModal('timeModal')">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Attendance</button>
            </div>
        </form>
    </div>
</div>

<!-- Cash Advance Modal -->
<div id="cashAdvanceModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal('cashAdvanceModal')">×</span>
        <h2>Record Cash Advance</h2>
        <form id="cashAdvanceForm">
            <div class="form-field">
                <select id="caEmployee" required>
                    <option value="">Select Employee</option>
                </select>
                <label>Employee</label>
            </div>
            <div class="form-field">
                <input type="date" id="caDate" required value="">
                <label>Date</label>
            </div>
            <div class="form-field">
                <input type="number" id="caAmount" step="0.01" min="1" required>
                <label>Amount (₱)</label>
            </div>
            <div style="margin-top:28px; display:flex; gap:16px; justify-content:flex-end;">
                <button type="button" class="btn btn-secondary" onclick="closeModal('cashAdvanceModal')">Cancel</button>
                <button type="submit" class="btn btn-primary">Record</button>
            </div>
        </form>
    </div>
</div>

<!-- Payroll Process Modal -->
<div id="payrollModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal('payrollModal')">×</span>
        <h2>Process Payroll</h2>
        <form id="payrollForm">
            <div class="form-field">
                <select id="payEmployee" required>
                    <option value="">Select Employee</option>
                </select>
                <label>Employee</label>
            </div>
            <div class="form-field">
                <input type="month" id="payPeriod" required>
                <label>Payroll Period</label>
            </div>
            <div class="form-field">
                <input type="number" id="baseSalary" step="0.01" min="0" required>
                <label>Base Salary (₱)</label>
            </div>
            <div class="form-field">
                <input type="number" id="salesAmount" step="0.01" min="0" value="0">
                <label>Sales Amount for 15% Commission (₱)</label>
            </div>
            <div style="margin-top:28px; display:flex; gap:16px; justify-content:flex-end;">
                <button type="button" class="btn btn-secondary" onclick="closeModal('payrollModal')">Cancel</button>
                <button type="submit" class="btn btn-primary">Compute & Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Payroll Approval / View Modal -->
<div id="approvalModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal('approvalModal')">×</span>
        <h2 id="approvalTitle">Payroll Details</h2>
        <div id="approvalDetails"></div>
        <div style="margin-top:28px; display:flex; gap:16px; justify-content:flex-end;" id="approvalButtons">
            <!-- Buttons will be dynamically inserted -->
        </div>
    </div>
</div>

<!-- Delete Payroll Confirmation Modal -->
<div id="deletePayrollModal" class="modal">
    <div class="modal-content" style="max-width:420px;">
        <span class="close-modal" onclick="closeModal('deletePayrollModal')">×</span>
        <h2>Delete Payroll Record</h2>
        <p>Are you sure you want to delete this payroll entry? This action cannot be undone.</p>
        <input type="hidden" id="deletePayrollIndex">
        <div style="margin-top:28px; display:flex; gap:16px; justify-content:flex-end;">
            <button type="button" class="btn btn-secondary" onclick="closeModal('deletePayrollModal')">Cancel</button>
            <button class="btn btn-danger" onclick="confirmDeletePayroll()">Delete</button>
        </div>
    </div>
</div>

<script src="ap.js"></script>
    </body>
</html>