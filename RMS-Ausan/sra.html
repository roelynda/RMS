<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Report & Analytics Dashboard</title>
    <link rel="stylesheet" href="Sales Report and Analytics/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
<body>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h2>RMS</h2>
        <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    </div>
    <div class="menu">
        <a class="menu-item" href="index.html">
            <i class="fas fa-home"></i>
            <span class="menu-text">Dashboard</span>
        </a>
        <a class="menu-item" href="inventory.html">
            <i class="fas fa-boxes-stacked"></i>
            <span class="menu-text">Inventory</span>
        </a>
        <a class="menu-item" href="cm.html">
            <i class="fas fa-users"></i>
            <span class="menu-text">Customers</span>
        </a>
        <a class="menu-item" href="erm.html">
            <i class="fas fa-user-tie"></i>
            <span class="menu-text">Employees & Roles</span>
        </a>
        <a class="menu-item" href="ap.html">
            <i class="fas fa-clock"></i>
            <span class="menu-text">Attendance & Payroll</span>
        </a>
        <a class="menu-item" href="service.html">
            <i class="fas fa-scissors"></i>
            <span class="menu-text">Services</span>
        </a>
        <a class="menu-item active" href="#">
            <i class="fas fa-chart-line"></i>
            <span class="menu-text">Sales Report</span>
        </a>
        <hr style="border-color:rgba(255,255,255,0.1); margin:15px 20px;">
        <a class="menu-item" href="#" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            <span class="menu-text">Logout</span>
        </a>
    </div>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
    <div class="topbar">
        <div class="page-title">Sales Report & Analytics</div>
        <a href="index.html" class="back-link">← Back to Dashboard</a>
    </div>

    <div class="content-card">
        <div class="stepper">
            <div class="step" id="step1"><span>1</span><div class="step-label">Collect Data</div></div>
            <div class="step" id="step2"><span>2</span><div class="step-label">Generate Report</div></div>
            <div class="step" id="step3"><span>3</span><div class="step-label">Verify Report</div></div>
            <div class="step" id="step4"><span>4</span><div class="step-label">Analyze Data</div></div>
        </div>

        <!-- Step 1: Collect Data -->
        <div id="collectData" class="step-content">
            <h2>Step 1: Collect Data</h2>
            <p>Data is aggregated from Services (appointment sales) and Payroll (commissions & costs), with Inventory cost analysis.</p>
            <p>Service appointments: <strong id="serviceCount">0</strong> | Payroll records: <strong id="payrollCount">0</strong> | Inventory items: <strong id="inventoryCount">0</strong></p>
            <button class="btn btn-primary" onclick="proceedToGenerate()">Generate Report</button>
        </div>

        <!-- Step 2: Generate Report -->
        <div id="generateReport" class="step-content hidden">
            <h2>Step 2: Generated Report</h2>
            <table>
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Employee/Specialist</th>
                        <th>Date/Period</th>
                        <th>Amount (₱)</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody id="reportTable"></tbody>
            </table>
            <div style="margin-top:20px; display:flex; gap:16px; justify-content:flex-end;">
                <button class="btn btn-success" onclick="confirmReport(true)">Report Correct</button>
                <button class="btn btn-danger" onclick="confirmReport(false)">Revise Report</button>
            </div>
        </div>

        <!-- Step 3: Revise Report -->
        <div id="reviseReport" class="step-content hidden">
            <h2>Step 3: Revise Report</h2>
            <p>Review and remove erroneous entries if needed.</p>
            <table class="revise-table">
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Employee/Specialist</th>
                        <th>Date/Period</th>
                        <th>Amount (₱)</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="reviseTable"></tbody>
            </table>
            <button class="btn btn-primary" onclick="regenerateReport()">Regenerate</button>
        </div>

        <!-- Step 4: Analyze Data -->
        <div id="analyzeData" class="step-content hidden">
            <h2>Step 4: Sales Analytics</h2>
            <div class="analytics">
                <div class="stat-card">
                    <p>Total Sales</p>
                    <h3 id="totalSales">₱0.00</h3>
                </div>
                <div class="stat-card">
                    <p>Total Payroll Costs</p>
                    <h3 id="totalPayroll">₱0.00</h3>
                </div>
                <div class="stat-card">
                    <p>Net Profit</p>
                    <h3 id="netProfit">₱0.00</h3>
                </div>
                <div class="stat-card">
                    <p>Average Sale</p>
                    <h3 id="avgSale">₱0.00</h3>
                </div>
                <div class="stat-card">
                    <p>Total Inventory Cost</p>
                    <h3 id="totalInventoryCost">₱0.00</h3>
                </div>
                <div class="stat-card">
                    <p>Low Stock Items</p>
                    <h3 id="lowStockCount">0</h3>
                </div>
            </div>

            <h2 style="margin-top:40px;">Employee Performance</h2>
            <table id="employeePerformanceTable">
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Total Sales Generated</th>
                        <th>Services Completed</th>
                        <th>Commissions Earned</th>
                        <th>Average Sale</th>
                    </tr>
                </thead>
                <tbody id="performanceTableBody"></tbody>
            </table>

            <div id="chartContainer">
                <canvas id="salesChart"></canvas>
            </div>

            <button class="btn btn-secondary" style="margin-top:30px;" onclick="resetFlow()">Start Over</button>
        </div>
    </div>
</div>

<script src="sra.js"></script>

</body>
</html>